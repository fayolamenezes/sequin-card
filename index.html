<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Scroll Tilt Card Stack</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: sans-serif;
      background: #f4f4f4;
      overflow-x: hidden;
    }

    .spacer {
      height: 50vh; /* Shows first card half */
      background: #000;
    }

    .section {
      height: 100vh;
      width: 100%;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .card-container {
      position: relative;
      width: 300px;
      height: 350px;
    }

    .card {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 0;
      box-shadow: none;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      transform-style: preserve-3d;
      background: #000;
    }

    .card img {
      width: 80%;
      height: auto;
    }

    .card.last {
      background: #eee;
      flex-direction: column;
      padding: 20px;
      text-align: center;
      color: #000;
    }

    .text-block-2 {
      font-size: 18px;
      font-weight: 600;
    }

    .big-text {
      font-size: 22px;
      margin: 10px 0;
    }

    .link-block {
      display: inline-block;
      padding: 12px 20px;
      margin-top: 15px;
      background: #000;
      color: #fff;
      text-decoration: none;
      border-radius: 6px;
      position: relative;
    }

    .corner-top-left,
    .corner-top-right,
    .corner-bottom-left,
    .corner-bottom-right {
      position: absolute;
      width: 20px;
      height: 20px;
    }

    .corner-top-left { top: 0; left: 0; }
    .corner-top-right { top: 0; right: 0; }
    .corner-bottom-left { bottom: 0; left: 0; }
    .corner-bottom-right { bottom: 0; right: 0; }

    .line-1,
    .line-2 {
      background: #fff;
      height: 2px;
      width: 100%;
      margin: 1px 0;
    }

    .div-block {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: transparent;
    }
  </style>
</head>
<body>

<div class="spacer"></div>

<section class="section" id="card-section">
  <div class="card-container">
    <div class="card one">
      <div class="div-block _1"></div>
      <img src="https://cdn.prod.website-files.com/6740471331c3ef2ba0ada212/67fcc3b1b7f86284660946aa_Frame%2060%20(6).svg" alt="">
    </div>
    <div class="card two">
      <div class="div-block _2"></div>
      <img src="https://cdn.prod.website-files.com/6740471331c3ef2ba0ada212/67f57f9a707cb3628987ed6d_Frame%2060%20(2).svg" alt="">
    </div>
    <div class="card three">
      <div class="div-block _3"></div>
      <img src="https://cdn.prod.website-files.com/6740471331c3ef2ba0ada212/67fcc3d2233f9c58b5167407_Frame%2061.svg" alt="">
    </div>
    <div class="card last bg-grey">
      <div class="text-block-2">Create your own style</div>
      <div class="big-text left-align mb">Get involved, and your design could be featured on our website!</div>
      <a id="button-glitch" href="/create-your-style" class="link-block bg-card w-inline-block">
        CREATE YOUR STYLE
        <div class="corner-top-left"><div class="line-1"></div><div class="line-2"></div></div>
        <div class="corner-top-right"><div class="line-1"></div><div class="line-2"></div></div>
        <div class="corner-bottom-left"><div class="line-1"></div><div class="line-2"></div></div>
        <div class="corner-bottom-right"><div class="line-1"></div><div class="line-2"></div></div>
      </a>
    </div>
  </div>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

<script>
  gsap.registerPlugin(ScrollTrigger);

  const cards = document.querySelectorAll('.card');
  const entryTilt = [11, -10, 7, 0];
  const finalTilt = [18, -16, 10, 0];

  // Initial setup: Cards stacked offscreen with subtle tilt and scale
  gsap.set(cards, {
    yPercent: 170,
    scale: 1.5,
    rotateZ: 0,
    opacity: 1,
    z: 0
  });

  const tl = gsap.timeline({
    scrollTrigger: {
      trigger: "#card-section",
      start: "top top",
      end: "+=4500",
      scrub: 1,
      pin: true,
      anticipatePin: 1,
    }
  });

cards.forEach((card, i) => {
  const isLast = card.classList.contains("last");
  const entryLabel = `card${i}-entry`;

  tl.addLabel(entryLabel);

  // Animate current card in slightly AFTER previous card starts tilting
  tl.to(card, {
    yPercent: 0,
    scale: 1,
    rotateZ: isLast ? 0 : entryTilt[i],
    z: i * 10,
    duration: 1,
    ease: "expo.out",
    onStart: () => card.style.zIndex = 20 + i
  }, i === 0 ? entryLabel : `>-0.4`); // Starts before previous finishes

  if (i > 0) {
    const prevCard = cards[i - 1];
    
    // Start tilting previous card slightly EARLIER than current card enters
    tl.to(prevCard, {
      rotateZ: finalTilt[i - 1],
      duration: 0.8,
      ease: "power3.out"
    }, `>-0.6`); // <<< Tilt starts *just* before the new card enters
  }
});

</script>

</body>
</html>